<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèí Puck Prophet</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Fira Code', monospace; background: #000; color: #00ff41; line-height: 1.6; }
        .header { background: linear-gradient(180deg, #000 0%, #001a00 100%); padding: 30px 20px; text-align: center; border-bottom: 3px solid #00ff41; }
        h1 { font-size: 3em; text-shadow: 0 0 20px #00ff41; }
        .container { max-width: 1400px; margin: 0 auto; padding: 30px 20px; }
        .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(550px, 1fr)); gap: 30px; }
        .game-card { background: #0a0a0a; border: 2px solid #00ff41; border-radius: 12px; overflow: hidden; transition: all 0.3s; }
        .game-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0, 255, 65, 0.3); }
        .game-header { background: #001a00; padding: 15px; text-align: center; border-bottom: 2px solid #00ff41; }
        .matchup { display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; padding: 30px; align-items: center; }
        .team { text-align: center; }
        .team-logo { width: 80px; height: 80px; margin: 0 auto 15px; border-radius: 50%; border: 2px solid #00ff41; overflow: hidden; }
        .team-logo img { width: 100%; height: 100%; object-fit: contain; }
        .vs { font-size: 2em; opacity: 0.5; }
        .goalie-card { background: #000; border: 1px solid #00ff41; border-radius: 8px; padding: 15px; margin-top: 15px; }
        .goalie-header { display: flex; align-items: center; gap: 15px; margin-bottom: 10px; }
        .goalie-headshot { width: 60px; height: 60px; border-radius: 50%; border: 2px solid #00ff41; overflow: hidden; }
        .goalie-headshot img { width: 100%; height: 100%; object-fit: cover; }
        .status { padding: 3px 8px; border-radius: 4px; font-size: 0.75em; font-weight: bold; margin-top: 3px; display: inline-block; }
        .status.CONFIRMED { background: #00ff41; color: #000; }
        .status.PROBABLE { background: #ffaa00; color: #000; }
        .status.LIKELY { background: #66ccff; color: #000; }
        .stats { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px; }
        .stat { background: #0a0a0a; padding: 8px; border-radius: 4px; text-align: center; font-size: 0.9em; }
        .prob-bars { margin: 15px 0; padding: 15px; background: #000; border: 1px solid #00ff41; border-radius: 8px; }
        .prob-bar { margin: 10px 0; }
        .prob-label { font-size: 0.85em; margin-bottom: 5px; display: flex; justify-content: space-between; }
        .bar { height: 8px; background: #0a0a0a; border-radius: 4px; overflow: hidden; }
        .bar-fill { height: 100%; background: #00ff41; transition: width 0.5s; }
        .confirmation { font-size: 0.8em; opacity: 0.8; margin-top: 10px; padding: 8px; background: #0a0a0a; border-radius: 4px; }
        .confirmation a { color: #00ff41; text-decoration: none; }
        .polymarket-section { background: #000; padding: 20px; border-top: 2px solid #00ff41; }
        .poly-embed { margin: 15px 0; border: 1px solid #00ff41; border-radius: 8px; overflow: hidden; }
        .analysis { background: #0a0a0a; border: 1px solid #00ff41; border-radius: 8px; padding: 15px; margin: 15px 0; font-size: 0.9em; line-height: 1.8; }
        .recommendation { padding: 10px 20px; background: #00ff41; color: #000; font-weight: bold; border-radius: 6px; margin: 15px 0; display: inline-block; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .loading { text-align: center; padding: 100px 20px; font-size: 1.5em; }
        @media (max-width: 768px) { .games-grid { grid-template-columns: 1fr; } .matchup { grid-template-columns: 1fr; gap: 30px; } .vs { transform: rotate(90deg); } }
    </style>
</head>
<body>
    <div class="header"><h1>üèí PUCK PROPHET</h1></div>
    <div class="container"><div class="games-grid" id="games"><div class="loading">Loading...</div></div></div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, onValue } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyCWia-DYC6KmVE4Uq2c-BlLsRPcTHZejco",
            authDomain: "puck-prophet.firebaseapp.com",
            databaseURL: "https://puck-prophet-default-rtdb.firebaseio.com",
            projectId: "puck-prophet",
            storageBucket: "puck-prophet.firebasestorage.app",
            messagingSenderId: "533581362707",
            appId: "1:533581362707:web:f06b7d36935d95230931e6"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        onValue(ref(db, 'games'), (snapshot) => {
            const data = snapshot.val() || {}, games = data.games || [];
            document.getElementById('games').innerHTML = games.length === 0 ? '<div class="loading">No games scheduled</div>' : games.map(g => `
                <div class="game-card">
                    <div class="game-header">${g.gameDate} ${g.gameTime} - ${g.venue}</div>
                    <div class="matchup">
                        <div class="team">
                            <div class="team-logo"><img src="${g.away.teamLogo}" alt="${g.away.teamAbbrev}"></div>
                            <h3>${g.away.teamAbbrev}</h3>
                            <div class="goalie-card">
                                <div class="goalie-header">
                                    <div class="goalie-headshot"><img src="${g.away.goalie.headshot}" alt="${g.away.goalie.name}"></div>
                                    <div>
                                        <h4>${g.away.goalie.name} #${g.away.goalie.number}</h4>
                                        <span class="status ${g.away.goalie.status}">${g.away.goalie.status}</span>
                                    </div>
                                </div>
                                <div class="stats">
                                    <div class="stat"><div style="opacity:0.7;">Record</div><strong>${g.away.goalie.stats.record}</strong></div>
                                    <div class="stat"><div style="opacity:0.7;">GAA</div><strong>${g.away.goalie.stats.gaa.toFixed(2)}</strong></div>
                                    <div class="stat"><div style="opacity:0.7;">SV%</div><strong>${g.away.goalie.stats.savePct.toFixed(3)}</strong></div>
                                    <div class="stat"><div style="opacity:0.7;">SO</div><strong>${g.away.goalie.stats.shutouts}</strong></div>
                                </div>
                                ${g.away.goalie.confirmationText || g.away.goalie.confirmationTweet ? `
                                    <div class="confirmation">
                                        ${g.away.goalie.confirmationText || 'Confirmed'}
                                        ${g.away.goalie.confirmationTweet ? ` <a href="${g.away.goalie.confirmationTweet}" target="_blank">üîó</a>` : ''}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                        <div class="vs">@</div>
                        <div class="team">
                            <div class="team-logo"><img src="${g.home.teamLogo}" alt="${g.home.teamAbbrev}"></div>
                            <h3>${g.home.teamAbbrev}</h3>
                            <div class="goalie-card">
                                <div class="goalie-header">
                                    <div class="goalie-headshot"><img src="${g.home.goalie.headshot}" alt="${g.home.goalie.name}"></div>
                                    <div>
                                        <h4>${g.home.goalie.name} #${g.home.goalie.number}</h4>
                                        <span class="status ${g.home.goalie.status}">${g.home.goalie.status}</span>
                                    </div>
                                </div>
                                <div class="stats">
                                    <div class="stat"><div style="opacity:0.7;">Record</div><strong>${g.home.goalie.stats.record}</strong></div>
                                    <div class="stat"><div style="opacity:0.7;">GAA</div><strong>${g.home.goalie.stats.gaa.toFixed(2)}</strong></div>
                                    <div class="stat"><div style="opacity:0.7;">SV%</div><strong>${g.home.goalie.stats.savePct.toFixed(3)}</strong></div>
                                    <div class="stat"><div style="opacity:0.7;">SO</div><strong>${g.home.goalie.stats.shutouts}</strong></div>
                                </div>
                                ${g.home.goalie.confirmationText || g.home.goalie.confirmationTweet ? `
                                    <div class="confirmation">
                                        ${g.home.goalie.confirmationText || 'Confirmed'}
                                        ${g.home.goalie.confirmationTweet ? ` <a href="${g.home.goalie.confirmationTweet}" target="_blank">üîó</a>` : ''}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                    <div class="prob-bars">
                        <h3 style="margin-bottom: 15px; text-align: center; color: #00ff41; border-bottom: 1px solid #00ff41; padding-bottom: 10px;">üìä PROJECTIONS</h3>
                        <div class="prob-bar">
                            <div class="prob-label"><span>${g.away.teamAbbrev} Win Probability</span><strong>${g.away.goalie.stats.winProb}%</strong></div>
                            <div class="bar"><div class="bar-fill" style="width:${g.away.goalie.stats.winProb}%"></div></div>
                        </div>
                        <div class="prob-bar">
                            <div class="prob-label"><span>${g.away.goalie.name} Projected Saves</span><strong>${g.away.goalie.stats.projSaves}</strong></div>
                            <div class="bar"><div class="bar-fill" style="width:${(g.away.goalie.stats.projSaves/40)*100}%"></div></div>
                        </div>
                        <div class="prob-bar">
                            <div class="prob-label"><span>${g.home.teamAbbrev} Win Probability</span><strong>${g.home.goalie.stats.winProb}%</strong></div>
                            <div class="bar"><div class="bar-fill" style="width:${g.home.goalie.stats.winProb}%"></div></div>
                        </div>
                        <div class="prob-bar">
                            <div class="prob-label"><span>${g.home.goalie.name} Projected Saves</span><strong>${g.home.goalie.stats.projSaves}</strong></div>
                            <div class="bar"><div class="bar-fill" style="width:${(g.home.goalie.stats.projSaves/40)*100}%"></div></div>
                        </div>
                    </div>
                    <div class="polymarket-section">
                        <h3 style="margin-bottom: 15px; text-align: center; color: #00ff41; font-size: 1.2em;">ü§ñ PUCK PROPHET AGENT PREDICTION</h3>
                        ${g.polymarket.marketId ? `
                            <div class="poly-embed">
                                <iframe title="polymarket-embed" src="https://embed.polymarket.com/market.html?market=${g.polymarket.marketId}&features=volume&theme=dark" width="100%" height="180" frameBorder="0"></iframe>
                            </div>
                        ` : ''}
                        ${g.polymarket.analysis ? `<div class="analysis">${g.polymarket.analysis}</div>` : ''}
                        ${g.polymarket.recommendation ? `<div class="recommendation">${g.polymarket.recommendation}</div>` : ''}
                    </div>
                </div>
            `).join('');
        });
    </script>
</body>
</html>
